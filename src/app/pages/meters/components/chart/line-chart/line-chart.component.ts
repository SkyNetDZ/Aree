import { Component, OnInit, ViewChild, ElementRef, Input, ViewEncapsulation } from "@angular/core";
import * as d3 from "d3";

@Component({
  selector: 'app-line-chart',
  templateUrl: './line-chart.component.html',
  styleUrls: ['./line-chart.component.css'],
  encapsulation: ViewEncapsulation.Native

})
export class LineChartComponent implements OnInit {

  @ViewChild('linechart') private chartContainer: ElementRef;
  // @Input() private data: Array<any>;
  private data: Array<any> = [{ d: "\/Date(1451602800000+0100)\/", v: 19.825000107288361 }, { d: "\/Date(1451689200000+0100)\/", v: 20.200000047683716 }, { d: "\/Date(1451775600000+0100)\/", v: 19.649999976158142 }, { d: "\/Date(1451862000000+0100)\/", v: 25.375 }, { d: "\/Date(1451948400000+0100)\/", v: 25.375 }, { d: "\/Date(1452034800000+0100)\/", v: 29.274999618530273 }, { d: "\/Date(1452121200000+0100)\/", v: 28.850000381469727 }, { d: "\/Date(1452207600000+0100)\/", v: 22.149999976158142 }, { d: "\/Date(1452294000000+0100)\/", v: 18.404166638851166 }, { d: "\/Date(1452380400000+0100)\/", v: 18.725000143051147 }, { d: "\/Date(1452466800000+0100)\/", v: 15.925000011920929 }, { d: "\/Date(1452553200000+0100)\/", v: 23.550000190734863 }, { d: "\/Date(1452639600000+0100)\/", v: 22.324999809265137 }, { d: "\/Date(1452726000000+0100)\/", v: 23.799999833106995 }, { d: "\/Date(1452812400000+0100)\/", v: 16.495833396911621 }, { d: "\/Date(1452898800000+0100)\/", v: 10.924999833106995 }, { d: "\/Date(1452985200000+0100)\/", v: 13.445833444595337 }, { d: "\/Date(1453071600000+0100)\/", v: 17.720833301544189 }, { d: "\/Date(1453158000000+0100)\/", v: 18.695833325386047 }, { d: "\/Date(1453244400000+0100)\/", v: 13.320833325386047 }, { d: "\/Date(1453330800000+0100)\/", v: 16.154166638851166 }, { d: "\/Date(1453417200000+0100)\/", v: 20.179166555404663 }, { d: "\/Date(1453503600000+0100)\/", v: 18.104166746139526 }, { d: "\/Date(1453590000000+0100)\/", v: 19.170833349227905 }, { d: "\/Date(1453676400000+0100)\/", v: 24.970833301544189 }, { d: "\/Date(1453762800000+0100)\/", v: 28.550000190734863 }, { d: "\/Date(1453849200000+0100)\/", v: 27.045833587646484 }, { d: "\/Date(1453935600000+0100)\/", v: 22.945833206176758 }, { d: "\/Date(1454022000000+0100)\/", v: 26.600000381469727 }, { d: "\/Date(1454108400000+0100)\/", v: 21.775000095367432 }, { d: "\/Date(1454194800000+0100)\/", v: 24.949999809265137 }, { d: "\/Date(1454281200000+0100)\/", v: 25.550000190734863 }, { d: "\/Date(1454367600000+0100)\/", v: 19.399999976158142 }, { d: "\/Date(1454454000000+0100)\/", v: 20.145833253860474 }, { d: "\/Date(1454540400000+0100)\/", v: 26.225000381469727 }, { d: "\/Date(1454626800000+0100)\/", v: 28.725000381469727 }, { d: "\/Date(1454713200000+0100)\/", v: 28.370833396911621 }, { d: "\/Date(1454799600000+0100)\/", v: 24.545833110809326 }, { d: "\/Date(1454886000000+0100)\/", v: 18.424999952316284 }, { d: "\/Date(1454972400000+0100)\/", v: 15.054166913032532 }, { d: "\/Date(1455058800000+0100)\/", v: 10.958333194255829 }, { d: "\/Date(1455145200000+0100)\/", v: 12.895833373069763 }, { d: "\/Date(1455231600000+0100)\/", v: 16.224999964237213 }, { d: "\/Date(1455318000000+0100)\/", v: 19.274999976158142 }, { d: "\/Date(1455404400000+0100)\/", v: 23.404166698455811 }, { d: "\/Date(1455490800000+0100)\/", v: 24.420833110809326 }, { d: "\/Date(1455577200000+0100)\/", v: 21.545833468437195 }, { d: "\/Date(1455663600000+0100)\/", v: 15.450000107288361 }, { d: "\/Date(1455750000000+0100)\/", v: 19.274999976158142 }, { d: "\/Date(1455836400000+0100)\/", v: 22.770833492279053 }, { d: "\/Date(1455922800000+0100)\/", v: 22.575000166893005 }, { d: "\/Date(1456009200000+0100)\/", v: 12.32916659116745 }, { d: "\/Date(1456095600000+0100)\/", v: 9.7000001668930054 }, { d: "\/Date(1456182000000+0100)\/", v: 13.145833194255829 }, { d: "\/Date(1456268400000+0100)\/", v: 15.395833283662796 }, { d: "\/Date(1456354800000+0100)\/", v: 19.016666650772095 }, { d: "\/Date(1456441200000+0100)\/", v: 19.649999976158142 }, { d: "\/Date(1456527600000+0100)\/", v: 19.345833420753479 }, { d: "\/Date(1456614000000+0100)\/", v: 16.091666638851166 }, { d: "\/Date(1456700400000+0100)\/", v: 16.67083328962326 }, { d: "\/Date(1456786800000+0100)\/", v: 17.699999988079071 }, { d: "\/Date(1456873200000+0100)\/", v: 14.045833230018616 }, { d: "\/Date(1456959600000+0100)\/", v: 20.200000047683716 }, { d: "\/Date(1457046000000+0100)\/", v: 20.74999988079071 }, { d: "\/Date(1457132400000+0100)\/", v: 14.950000107288361 }, { d: "\/Date(1457218800000+0100)\/", v: 12.004166781902313 }, { d: "\/Date(1457305200000+0100)\/", v: 12.825000107288361 }, { d: "\/Date(1457391600000+0100)\/", v: 9.7541666030883789 }, { d: "\/Date(1457478000000+0100)\/", v: 9.7749998569488525 }, { d: "\/Date(1457564400000+0100)\/", v: 13.145833194255829 }, { d: "\/Date(1457650800000+0100)\/", v: 16.350000023841858 }, { d: "\/Date(1457737200000+0100)\/", v: 15.179166674613953 }, { d: "\/Date(1457823600000+0100)\/", v: 15.325000166893005 }, { d: "\/Date(1457910000000+0100)\/", v: 12.625000178813934 }, { d: "\/Date(1457996400000+0100)\/", v: 17.554166674613953 }, { d: "\/Date(1458082800000+0100)\/", v: 18.300000190734863 }, { d: "\/Date(1458169200000+0100)\/", v: 8.21666705608368 }, { d: "\/Date(1458255600000+0100)\/", v: 14.900000035762787 }, { d: "\/Date(1458342000000+0100)\/", v: 15.645833373069763 }, { d: "\/Date(1458428400000+0100)\/", v: 15.925000071525574 }, { d: "\/Date(1458514800000+0100)\/", v: 13.12500011920929 }, { d: "\/Date(1458601200000+0100)\/", v: 14.225000023841858 }, { d: "\/Date(1458687600000+0100)\/", v: 14.100000083446503 }, { d: "\/Date(1458774000000+0100)\/", v: 9.2750003784894943 }, { d: "\/Date(1458860400000+0100)\/", v: 1.2791666984558106 }, { d: "\/Date(1458946800000+0100)\/", v: 10.149999856948853 }, { d: "\/Date(1459033200000+0100)\/", v: 8.4041664600372314 }, { d: "\/Date(1459116000000+0200)\/", v: 16.133333325386047 }, { d: "\/Date(1459202400000+0200)\/", v: 13.745833337306976 }, { d: "\/Date(1459288800000+0200)\/", v: 17.074999928474426 }, { d: "\/Date(1459375200000+0200)\/", v: 14.475000083446503 }, { d: "\/Date(1459461600000+0200)\/", v: 16.475000023841858 }, { d: "\/Date(1459548000000+0200)\/", v: 17.449999988079071 }, { d: "\/Date(1459634400000+0200)\/", v: 17.575000047683716 }, { d: "\/Date(1459720800000+0200)\/", v: 16.495833396911621 }, { d: "\/Date(1459807200000+0200)\/", v: 13.000000178813934 }, { d: "\/Date(1459893600000+0200)\/", v: 8.9541664123535156 }, { d: "\/Date(1459980000000+0200)\/", v: 10.429166555404663 }, { d: "\/Date(1460066400000+0200)\/", v: 8.3750003576278687 }, { d: "\/Date(1460152800000+0200)\/", v: 0.9958338737487793 }, { d: "\/Date(1460239200000+0200)\/", v: 4.6499996185302734 }, { d: "\/Date(1460325600000+0200)\/", v: 6.7958331108093262 }, { d: "\/Date(1460412000000+0200)\/", v: 2.7291662693023682 }, { d: "\/Date(1460498400000+0200)\/", v: 0 }, { d: "\/Date(1460584800000+0200)\/", v: 0 }, { d: "\/Date(1460671200000+0200)\/", v: 0 }, { d: "\/Date(1460757600000+0200)\/", v: 0 }, { d: "\/Date(1460844000000+0200)\/", v: 3.445833683013916 }, { d: "\/Date(1460930400000+0200)\/", v: 11.454166889190674 }, { d: "\/Date(1461016800000+0200)\/", v: 13.375 }, { d: "\/Date(1461103200000+0200)\/", v: 13.995833277702332 }, { d: "\/Date(1461189600000+0200)\/", v: 10.149999797344208 }, { d: "\/Date(1461276000000+0200)\/", v: 2.7833333015441895 }, { d: "\/Date(1461362400000+0200)\/", v: 10.395833373069763 }, { d: "\/Date(1461448800000+0200)\/", v: 11.599999785423279 }, { d: "\/Date(1461535200000+0200)\/", v: 7.9291665554046631 }, { d: "\/Date(1461621600000+0200)\/", v: 9.8458335399627686 }, { d: "\/Date(1461708000000+0200)\/", v: 7.7291667461395264 }, { d: "\/Date(1461794400000+0200)\/", v: 5.0958333015441895 }, { d: "\/Date(1461880800000+0200)\/", v: 7.1083328723907471 }, { d: "\/Date(1461967200000+0200)\/", v: 2.7708337306976318 }, { d: "\/Date(1462053600000+0200)\/", v: 2.3958334922790527 }, { d: "\/Date(1462140000000+0200)\/", v: 0 }, { d: "\/Date(1462226400000+0200)\/", v: 0 }, { d: "\/Date(1462312800000+0200)\/", v: 2.8249998092651367 }, { d: "\/Date(1462399200000+0200)\/", v: 9.9291669130325317 }, { d: "\/Date(1462485600000+0200)\/", v: 9.1416664123535156 }, { d: "\/Date(1462572000000+0200)\/", v: 8.0208337306976318 }, { d: "\/Date(1462658400000+0200)\/", v: 2.8958339691162109 }, { d: "\/Date(1462744800000+0200)\/", v: 4.3999996185302734 }, { d: "\/Date(1462831200000+0200)\/", v: 4.5041666030883789 }, { d: "\/Date(1462917600000+0200)\/", v: 4.6833329200744629 }, { d: "\/Date(1463004000000+0200)\/", v: 7.7208333015441895 }, { d: "\/Date(1463090400000+0200)\/", v: 5.9458332061767578 }, { d: "\/Date(1463176800000+0200)\/", v: 6.9208331108093262 }, { d: "\/Date(1463263200000+0200)\/", v: 6.6500000953674316 }, { d: "\/Date(1463349600000+0200)\/", v: 4.5458331108093262 }, { d: "\/Date(1463436000000+0200)\/", v: 4.02500057220459 }, { d: "\/Date(1463522400000+0200)\/", v: 2.8958337306976318 }, { d: "\/Date(1463608800000+0200)\/", v: 0.67499971389770508 }, { d: "\/Date(1463695200000+0200)\/", v: 0.14583301544189453 }, { d: "\/Date(1463781600000+0200)\/", v: 0 }, { d: "\/Date(1463868000000+0200)\/", v: 0 }, { d: "\/Date(1463954400000+0200)\/", v: 0 }, { d: "\/Date(1464040800000+0200)\/", v: 2.0958328247070312 }, { d: "\/Date(1464127200000+0200)\/", v: 0.45833277702331543 }, { d: "\/Date(1464213600000+0200)\/", v: 0 }, { d: "\/Date(1464300000000+0200)\/", v: 0 }, { d: "\/Date(1464386400000+0200)\/", v: 0 }, { d: "\/Date(1464472800000+0200)\/", v: 0 }, { d: "\/Date(1464559200000+0200)\/", v: 0 }, { d: "\/Date(1464645600000+0200)\/", v: 0 }, { d: "\/Date(1464732000000+0200)\/", v: 0 }, { d: "\/Date(1464818400000+0200)\/", v: 0 }, { d: "\/Date(1464904800000+0200)\/", v: 0 }, { d: "\/Date(1464991200000+0200)\/", v: 0 }, { d: "\/Date(1465077600000+0200)\/", v: 0 }, { d: "\/Date(1465164000000+0200)\/", v: 0 }, { d: "\/Date(1465250400000+0200)\/", v: 0 }, { d: "\/Date(1465336800000+0200)\/", v: 0 }, { d: "\/Date(1465423200000+0200)\/", v: 0 }, { d: "\/Date(1465509600000+0200)\/", v: 0.4999995231628418 }, { d: "\/Date(1465596000000+0200)\/", v: 0 }, { d: "\/Date(1465682400000+0200)\/", v: 0 }, { d: "\/Date(1465768800000+0200)\/", v: 0 }, { d: "\/Date(1465855200000+0200)\/", v: 0 }, { d: "\/Date(1465941600000+0200)\/", v: 0 }, { d: "\/Date(1466028000000+0200)\/", v: 2.0250000953674316 }, { d: "\/Date(1466114400000+0200)\/", v: 0 }, { d: "\/Date(1466200800000+0200)\/", v: 0 }, { d: "\/Date(1466287200000+0200)\/", v: 0 }, { d: "\/Date(1466373600000+0200)\/", v: 0 }, { d: "\/Date(1466460000000+0200)\/", v: 5.5 }, { d: "\/Date(1466546400000+0200)\/", v: 2.875 }, { d: "\/Date(1466632800000+0200)\/", v: 1.370833158493042 }, { d: "\/Date(1466719200000+0200)\/", v: 0 }, { d: "\/Date(1466805600000+0200)\/", v: 0 }, { d: "\/Date(1466892000000+0200)\/", v: 0 }, { d: "\/Date(1466978400000+0200)\/", v: 0 }, { d: "\/Date(1467064800000+0200)\/", v: 0 }, { d: "\/Date(1467151200000+0200)\/", v: 0.77083349227905273 }, { d: "\/Date(1467237600000+0200)\/", v: 0 }, { d: "\/Date(1467324000000+0200)\/", v: 0 }, { d: "\/Date(1467410400000+0200)\/", v: 0 }, { d: "\/Date(1467496800000+0200)\/", v: 0 }, { d: "\/Date(1467583200000+0200)\/", v: 0 }, { d: "\/Date(1467669600000+0200)\/", v: 0 }, { d: "\/Date(1467756000000+0200)\/", v: 0 }, { d: "\/Date(1467842400000+0200)\/", v: 0 }, { d: "\/Date(1467928800000+0200)\/", v: 0 }, { d: "\/Date(1468015200000+0200)\/", v: 0 }, { d: "\/Date(1468101600000+0200)\/", v: 0 }, { d: "\/Date(1468188000000+0200)\/", v: 0 }, { d: "\/Date(1468274400000+0200)\/", v: 0 }, { d: "\/Date(1468360800000+0200)\/", v: 0 }, { d: "\/Date(1468447200000+0200)\/", v: 0 }, { d: "\/Date(1468533600000+0200)\/", v: 0 }, { d: "\/Date(1468620000000+0200)\/", v: 0 }, { d: "\/Date(1468706400000+0200)\/", v: 0 }, { d: "\/Date(1468792800000+0200)\/", v: 0 }, { d: "\/Date(1468879200000+0200)\/", v: 0 }, { d: "\/Date(1468965600000+0200)\/", v: 0 }, { d: "\/Date(1469052000000+0200)\/", v: 0 }, { d: "\/Date(1469138400000+0200)\/", v: 0 }, { d: "\/Date(1469224800000+0200)\/", v: 0 }, { d: "\/Date(1469311200000+0200)\/", v: 0 }, { d: "\/Date(1469397600000+0200)\/", v: 0 }, { d: "\/Date(1469484000000+0200)\/", v: 0 }, { d: "\/Date(1469570400000+0200)\/", v: 0 }, { d: "\/Date(1469656800000+0200)\/", v: 0 }, { d: "\/Date(1469743200000+0200)\/", v: 0 }, { d: "\/Date(1469829600000+0200)\/", v: 0 }, { d: "\/Date(1469916000000+0200)\/", v: 0 }, { d: "\/Date(1470002400000+0200)\/", v: 0 }, { d: "\/Date(1470088800000+0200)\/", v: 0 }, { d: "\/Date(1470175200000+0200)\/", v: 0 }, { d: "\/Date(1470261600000+0200)\/", v: 0 }, { d: "\/Date(1470348000000+0200)\/", v: 1.5291666984558106 }, { d: "\/Date(1470434400000+0200)\/", v: 0 }, { d: "\/Date(1470520800000+0200)\/", v: 0 }, { d: "\/Date(1470607200000+0200)\/", v: 0 }, { d: "\/Date(1470693600000+0200)\/", v: 0 }, { d: "\/Date(1470780000000+0200)\/", v: 0 }, { d: "\/Date(1470866400000+0200)\/", v: 0 }, { d: "\/Date(1470952800000+0200)\/", v: 0 }, { d: "\/Date(1471039200000+0200)\/", v: 0 }, { d: "\/Date(1471125600000+0200)\/", v: 0 }, { d: "\/Date(1471212000000+0200)\/", v: 0 }, { d: "\/Date(1471298400000+0200)\/", v: 0 }, { d: "\/Date(1471384800000+0200)\/", v: 0 }, { d: "\/Date(1471471200000+0200)\/", v: 0 }, { d: "\/Date(1471557600000+0200)\/", v: 0 }, { d: "\/Date(1471644000000+0200)\/", v: 0 }, { d: "\/Date(1471730400000+0200)\/", v: 0 }, { d: "\/Date(1471816800000+0200)\/", v: 0 }, { d: "\/Date(1471903200000+0200)\/", v: 0 }, { d: "\/Date(1471989600000+0200)\/", v: 0 }, { d: "\/Date(1472076000000+0200)\/", v: 0 }, { d: "\/Date(1472162400000+0200)\/", v: 0 }, { d: "\/Date(1472248800000+0200)\/", v: 0 }, { d: "\/Date(1472335200000+0200)\/", v: 0 }, { d: "\/Date(1472421600000+0200)\/", v: 0 }, { d: "\/Date(1472508000000+0200)\/", v: 0.19999980926513672 }, { d: "\/Date(1472594400000+0200)\/", v: 0.32499980926513672 }, { d: "\/Date(1472680800000+0200)\/", v: 2.1999998092651367 }, { d: "\/Date(1472767200000+0200)\/", v: 0 }, { d: "\/Date(1472853600000+0200)\/", v: 0 }, { d: "\/Date(1472940000000+0200)\/", v: 0 }, { d: "\/Date(1473026400000+0200)\/", v: 0 }, { d: "\/Date(1473112800000+0200)\/", v: 0 }, { d: "\/Date(1473199200000+0200)\/", v: 0 }, { d: "\/Date(1473285600000+0200)\/", v: 0 }, { d: "\/Date(1473372000000+0200)\/", v: 0 }, { d: "\/Date(1473458400000+0200)\/", v: 0 }, { d: "\/Date(1473544800000+0200)\/", v: 3 }, { d: "\/Date(1473631200000+0200)\/", v: 1.6000003814697266 }, { d: "\/Date(1473717600000+0200)\/", v: 0 }, { d: "\/Date(1473804000000+0200)\/", v: 0 }, { d: "\/Date(1473890400000+0200)\/", v: 0 }, { d: "\/Date(1473976800000+0200)\/", v: 0 }, { d: "\/Date(1474063200000+0200)\/", v: 1.9749999046325684 }, { d: "\/Date(1474149600000+0200)\/", v: 3.9249997138977051 }, { d: "\/Date(1474236000000+0200)\/", v: 5.0958333015441895 }, { d: "\/Date(1474322400000+0200)\/", v: 1.258333683013916 }, { d: "\/Date(1474408800000+0200)\/", v: 0.94583320617675781 }, { d: "\/Date(1474495200000+0200)\/", v: 2.9250001907348633 }, { d: "\/Date(1474581600000+0200)\/", v: 4.245833158493042 }, { d: "\/Date(1474668000000+0200)\/", v: 0 }, { d: "\/Date(1474754400000+0200)\/", v: 0 }, { d: "\/Date(1474840800000+0200)\/", v: 0 }, { d: "\/Date(1474927200000+0200)\/", v: 1.3500003814697266 }, { d: "\/Date(1475013600000+0200)\/", v: 3.6000003814697266 }, { d: "\/Date(1475100000000+0200)\/", v: 3.945833683013916 }, { d: "\/Date(1475186400000+0200)\/", v: 2.27500057220459 }, { d: "\/Date(1475272800000+0200)\/", v: 1.0291662216186523 }, { d: "\/Date(1475359200000+0200)\/", v: 5.1999998092651367 }, { d: "\/Date(1475445600000+0200)\/", v: 4.3499999046325684 }, { d: "\/Date(1475532000000+0200)\/", v: 6.4541668891906738 }, { d: "\/Date(1475618400000+0200)\/", v: 9.6791665554046631 }, { d: "\/Date(1475704800000+0200)\/", v: 10.820833206176758 }, { d: "\/Date(1475791200000+0200)\/", v: 4.1000003814697266 }, { d: "\/Date(1475877600000+0200)\/", v: 3.2291665077209473 }, { d: "\/Date(1475964000000+0200)\/", v: 3.8708329200744629 }, { d: "\/Date(1476050400000+0200)\/", v: 4.7749996185302734 }, { d: "\/Date(1476136800000+0200)\/", v: 7.7708332538604736 }, { d: "\/Date(1476223200000+0200)\/", v: 11.600000023841858 }, { d: "\/Date(1476309600000+0200)\/", v: 12.399999797344208 }, { d: "\/Date(1476396000000+0200)\/", v: 8.995833158493042 }, { d: "\/Date(1476482400000+0200)\/", v: 10.945833519101143 }, { d: "\/Date(1476568800000+0200)\/", v: 7.2208335399627686 }, { d: "\/Date(1476655200000+0200)\/", v: 8.6958330869674683 }, { d: "\/Date(1476741600000+0200)\/", v: 5.3958337306976318 }, { d: "\/Date(1476828000000+0200)\/", v: 0 }, { d: "\/Date(1476914400000+0200)\/", v: 0 }, { d: "\/Date(1477000800000+0200)\/", v: 8.995833158493042 }, { d: "\/Date(1477087200000+0200)\/", v: 11.504166889935732 }, { d: "\/Date(1477173600000+0200)\/", v: 5.7791666984558105 }, { d: "\/Date(1477260000000+0200)\/", v: 8.9541666507720947 }, { d: "\/Date(1477346400000+0200)\/", v: 7.0541665554046631 }, { d: "\/Date(1477432800000+0200)\/", v: 9.9499999284744263 }, { d: "\/Date(1477519200000+0200)\/", v: 8.4250001907348633 }, { d: "\/Date(1477605600000+0200)\/", v: 5.1999998092651367 }, { d: "\/Date(1477692000000+0200)\/", v: 8.1458332538604736 }, { d: "\/Date(1477778400000+0200)\/", v: 8.6541664600372314 }, { d: "\/Date(1477868400000+0100)\/", v: 0.3749995231628418 }, { d: "\/Date(1477954800000+0100)\/", v: 0 }, { d: "\/Date(1478041200000+0100)\/", v: 5.0958333015441895 }, { d: "\/Date(1478127600000+0100)\/", v: 6.4541668891906738 }, { d: "\/Date(1478214000000+0100)\/", v: 4.7208333015441895 }, { d: "\/Date(1478300400000+0100)\/", v: 4.5041666030883789 }, { d: "\/Date(1478386800000+0100)\/", v: 2.7499995231628418 }, { d: "\/Date(1478473200000+0100)\/", v: 1.3500003814697266 }, { d: "\/Date(1478559600000+0100)\/", v: 15.875 }, { d: "\/Date(1478646000000+0100)\/", v: 16.495833277702332 }, { d: "\/Date(1478732400000+0100)\/", v: 18.820833325386047 }, { d: "\/Date(1478818800000+0100)\/", v: 17.75 }, { d: "\/Date(1478905200000+0100)\/", v: 11.725000083446503 }, { d: "\/Date(1478991600000+0100)\/", v: 7.1499998569488525 }, { d: "\/Date(1479078000000+0100)\/", v: 10.604166746139526 }, { d: "\/Date(1479164400000+0100)\/", v: 13.725000083446503 }, { d: "\/Date(1479250800000+0100)\/", v: 13.954166531562805 }, { d: "\/Date(1479337200000+0100)\/", v: 14.349999904632568 }, { d: "\/Date(1479423600000+0100)\/", v: 7.875 }, { d: "\/Date(1479510000000+0100)\/", v: 19.099999964237213 }, { d: "\/Date(1479596400000+0100)\/", v: 18.25 }, { d: "\/Date(1479682800000+0100)\/", v: 15.800000011920929 }, { d: "\/Date(1479769200000+0100)\/", v: 16.225000023841858 }, { d: "\/Date(1479855600000+0100)\/", v: 21.920833349227905 }, { d: "\/Date(1479942000000+0100)\/", v: 26.050000190734863 }, { d: "\/Date(1480028400000+0100)\/", v: 24.099999904632568 }, { d: "\/Date(1480114800000+0100)\/", v: 24.400000095367432 }, { d: "\/Date(1480201200000+0100)\/", v: 23.799999892711639 }, { d: "\/Date(1480287600000+0100)\/", v: 19.6291663646698 }, { d: "\/Date(1480374000000+0100)\/", v: 13.466666579246521 }, { d: "\/Date(1480460400000+0100)\/", v: 17.75 }, { d: "\/Date(1480546800000+0100)\/", v: 19.679166793823242 }, { d: "\/Date(1480633200000+0100)\/", v: 16.370833292603493 }, { d: "\/Date(1480719600000+0100)\/", v: 18.779166698455811 }, { d: "\/Date(1480806000000+0100)\/", v: 16.495833396911621 }, { d: "\/Date(1480892400000+0100)\/", v: 10.479166746139526 }, { d: "\/Date(1480978800000+0100)\/", v: 17.220833301544189 }, { d: "\/Date(1481065200000+0100)\/", v: 21.049999952316284 }, { d: "\/Date(1481151600000+0100)\/", v: 22.150000095367432 }, { d: "\/Date(1481238000000+0100)\/", v: 22.045833110809326 }, { d: "\/Date(1481324400000+0100)\/", v: 21.154166758060455 }, { d: "\/Date(1481410800000+0100)\/", v: 17.449999988079071 }, { d: "\/Date(1481497200000+0100)\/", v: 18.550000011920929 }, { d: "\/Date(1481583600000+0100)\/", v: 23.300000190734863 }, { d: "\/Date(1481670000000+0100)\/", v: 24.400000095367432 }, { d: "\/Date(1481756400000+0100)\/", v: 22.275000095367432 }, { d: "\/Date(1481842800000+0100)\/", v: 24.949999809265137 }, { d: "\/Date(1481929200000+0100)\/", v: 26.050000190734863 }, { d: "\/Date(1482015600000+0100)\/", v: 27.045833587646484 }, { d: "\/Date(1482102000000+0100)\/", v: 23.975000083446503 }, { d: "\/Date(1482188400000+0100)\/", v: 17.874999985098839 }, { d: "\/Date(1482274800000+0100)\/", v: 22.045833110809326 }, { d: "\/Date(1482361200000+0100)\/", v: 21.775000095367432 }, { d: "\/Date(1482447600000+0100)\/", v: 22.295833140611649 }, { d: "\/Date(1482534000000+0100)\/", v: 19.824999988079071 }, { d: "\/Date(1482620400000+0100)\/", v: 19.399999976158142 }, { d: "\/Date(1482706800000+0100)\/", v: 21.495833396911621 }, { d: "\/Date(1482793200000+0100)\/", v: 26.725000381469727 }, { d: "\/Date(1482879600000+0100)\/", v: 25.770833611488342 }, { d: "\/Date(1482966000000+0100)\/", v: 18.570833325386047 }, { d: "\/Date(1483052400000+0100)\/", v: 20.820833444595337 }, { d: "\/Date(1483138800000+0100)\/", v: 20.820833444595337 }];
  private margin = { top: 20, right: 20, bottom: 30, left: 40 };
  private chart: any;
  private width: number;
  private height: number;
  private xScale: any;
  private yScale: any;
  private colors: any;
  private xAxis: any;
  private yAxis: any;
  private x: any;
  private y: any;
  private svg: any;
  private g: any;

  constructor() {
  }

  ngOnInit() {
    this.createChart();
    // if (this.data) {
    //   this.updateChart();
    // }
  }

  ngOnChanges() {
    // if (this.chart) {
    //   this.updateChart();
    // }
  }

  private initSvg() {
    let element = this.chartContainer.nativeElement;
    this.svg = d3.select(element).append('svg')
      .attr('width', 1000)
      .attr('height', 400)
      .call(this.responsivefy);
    this.width = +this.svg.attr("width") - this.margin.left - this.margin.right;
    this.height = +this.svg.attr("height") - this.margin.top - this.margin.bottom;
    this.g = this.svg.append("g")
      .attr("transform", "translate(" + this.margin.left + "," + this.margin.top + ")");
  }

  private initAxis() {
    let xDomain = this.data.map(d => new Date(parseInt((d.d).substr(6, 24))));
    let yDomain = [0, d3.max(this.data, d => d.v)];
    this.x = d3.scaleTime().domain([d3.min(xDomain), d3.max(xDomain)]).rangeRound([0, this.width]);
    this.y = d3.scaleLinear().domain(yDomain).rangeRound([this.height, 0]);

  }

  private drawAxis() {
    this.g.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + this.height + ")")
      .call(
      d3.axisBottom(this.x)
        .ticks(d3.timeMonth.every(1))
        .tickFormat(d3.timeFormat("%b/%Y")))
    .selectAll('text')
    .style("text-anchor", "end")
          .attr("dx", "-.8em")
          .attr("dy", ".15em")
          .attr("transform", "rotate(-30)");

    this.g.append("g")
      .attr("class", "axis axis--y")
      .call(d3.axisLeft(this.y).ticks(10, ""))
      .append("text")
      .attr("class", "axis-title")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", "0.71em")
      .attr("text-anchor", "end")
      .text("Temp (C°)");
  }



  private drawLine() {
    let line = d3.line()
      .x((d: any) => this.x(new Date(parseInt((d.d).substr(6)))))
      .y((d: any) => this.y(d.v));

    let path = this.g.append('path')
      .datum(this.data)
      .attr("class", "line")
      .attr("d", line);
  }

  createChart() {
    this.initSvg();
    this.initAxis();
    this.drawAxis();
    this.drawLine();
  }

  updateChart() {
    // update scales & axis
    this.xScale.domain(this.data.map(d => new Date(parseInt((d.d).substr(6, 24)))));
    this.yScale.domain([0, d3.max(this.data, d => d.v)]);
    this.colors.domain([0, this.data.length]);
    this.xAxis.transition().call(d3.axisBottom(this.xScale).tickFormat(d3.timeFormat("%d/%m/%Y")));
    this.yAxis.transition().call(d3.axisLeft(this.yScale));

    let update = this.chart.selectAll('.bar')
      .data(this.data);

    // remove exiting bars
    update.exit().remove();

    // update existing bars
    this.chart.selectAll('.bar').transition()
      .attr('x', d => this.xScale(new Date(parseInt((d.d).substr(6, 24)))))
      .attr('y', d => this.yScale(d.v))
      .attr('width', d => this.xScale.bandwidth())
      .attr('height', d => this.height - this.yScale(d.v))
      .style('fill', (d, i) => this.colors(i));

    // add new bars
    update
      .enter()
      .append('rect')
      .attr('class', 'bar')
      .attr('x', d => this.xScale(new Date(parseInt((d.d).substr(6, 24)))))
      .attr('y', d => this.yScale(0))
      .attr('width', this.xScale.bandwidth())
      .attr('height', 0)
      .style('fill', (d, i) => this.colors(i))
      .transition()
      .delay((d, i) => i * 10)
      .attr('y', d => this.yScale(d.v))
      .attr('height', d => this.height - this.yScale(d.v));
  }

  responsivefy(svg) {
    // get container + svg aspect ratio
    let container = d3.select(svg.node().parentNode),
      width = parseInt(svg.style("width")),
      height = parseInt(svg.style("height")),
      aspect = width / height;

    // add viewBox and preserveAspectRatio properties,
    // and call resize so that svg resizes on inital page load
    svg.attr("viewBox", "0 0 " + width + " " + height)
      .attr("preserveAspectRatio", "xMinYMid")
      .call(resize);

    //TODO Label axis

    // to register multiple listeners for same event type,
    // you need to add namespace, i.e., 'click.foo'
    // necessary if you call invoke this function for multiple svgs
    // api docs: https://github.com/mbostock/d3/wiki/Selections#on
    d3.select(window).on("resize." + container.attr("id"), resize);

    // get width of container and resize svg to fit it
    function resize() {
      let targetWidth = parseInt(container.style("width"));
      svg.attr("width", targetWidth);
      svg.attr("height", Math.round(targetWidth / aspect));
    }
  }

}
